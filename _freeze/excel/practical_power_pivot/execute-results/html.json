{
  "hash": "ce1f3a91f447c0822399f21db89d4a1d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Practical PowerPivot\"\ndate: \"2025-03-06\"\nexecute: \n  echo: true\n  freeze: auto\ncategories: [excel, intermediate]\n\n---\n\n::: {.cell layout-align=\"left\"}\nNo feedback found for this session\n:::\n\n\n\n## Welcome\n\n-   this session is [ðŸŒ¶ðŸŒ¶]{style=\"color:red;\"}, so it's designed for intermediate users with plenty of previous Excel Pivot Table experience\n- this session is **not** a general introduction to Pivot Tables in Excel\n- instead, it's designed as a high-level introduction to Power Pivot\n\n## Session outline\n\n-   check that you have Power Pivot please!\n    - useful [guide for M365](https://support.microsoft.com/en-gb/office/start-the-power-pivot-add-in-for-excel-a891a66d-36e3-43fc-81e8-fc4798f39ea8)\n    - [PowerPivot infrastructure varies widely](https://support.microsoft.com/en-gb/office/where-is-power-pivot-aa64e217-4b6e-410b-8337-20b87e1c2a4b), so we can't advise on installation\n-   find and tidy some data in Excel\n-   add to Power Pivot\n-   look at the data model and create relationships\n- create a pivot table from that data\n- create calculated columns in the data model\n- create measures and add to a pivot table\n\n## Words of warning\n\n- Power Pivot is glitchy\n-   Power Pivot in Excel is still officially supported, but has been largely replaced by Power BI\n    -   I'd be very circumspect about its long-term prospects\n    -   I'd also be cautious about starting more ambitious projects in Power Pivot\n-   That said, knowing a bit of Power Pivot is definitely worthwhile - especially if you're not able to use Power BI etc\n\n## Nutshell\n\n-   PowerPivot = effectively a [local SSAS](https://learn.microsoft.com/en-us/analysis-services/ssas-overview?view=asallproducts-allversions)\n-   that means PowerPivot allows you to do fancy relational work with your data\n-   it *can* also means higher performance with large (10k rows +) data\n-   yet allows you to use Excel for data ingest and output\n\n## Data\n\n-   download the [Agatha Christie dataset](https://docs.google.com/spreadsheets/d/1A8ZRe5KLLAllhT31pCzke4j5qAPqeMKf0jYgyJXcoPs/edit#gid=564606948) as an Excel file\n-   tidying:\n    -   remove filters </br>![Remove filters](images/clipboard-835331234.png)\n    -   create 4 x named tables for each of the four main data sheets:\n        -   `novels`\n        -   `short_stories`\n        -   `short_story_collections`\n        -   `all_titles`\n\n## Add data to Power Pivot\n\n-   find Power Pivot in the ribbon menu\n-   now add each table in turn to your data model </br> ![Add four tabhles to the data model](images/clipboard-657264833.png)\n\n## The data view\n\n-   data view </br>![data view](images/clipboard-3263737736.png)\n\n## The diagram view\n\n-   diagram view </br>![diagram view](images/clipboard-4246528073.png)\n\n## Relationships\n\n-   you can create relationships between different parts of your data\n-   that's useful as you can then exploit those relationships using DAX formulas\n-   open the diagram view, and connect the other three `Title ID` columns to `all_titles[Title ID]` </br>![Build relationships](images/clipboard-4256752901.png){height=\"400px\"}\n\n## Make a Pivot Table\n\n-   this should feel nice and familiar: please insert a pivot table (from Power Pivot)\n-   that should bring up a nearly-standard set of pivot table tools. One immediate difference though: you can work across several tables </br>![Several data sources in one pivot table](images/clipboard-3068291267.png)\n\n## Make a Pivot Table\n\n::::: columns\n::: {.column width=\"40%\"}\n![Pivot table fields](images/clipboard-3092995500.png)\n:::\n\n::: {.column width=\"60%\"}\n![Output](images/clipboard-45311937.png)\n:::\n:::::\n\n## DAX\n\n- Power Pivot is based on DAX (**D**ata **A**nalysis e**X**pressions)\n- similar to Excel formula language\n- a major difference: you can't reference individual cells\n- we'll use structured references: `table[column]`\n\n## Make a new column\n\n-   `=MROUND(short_story_collections[Year of first publication], 10)`\n-   rename to `Decade`\n-   refresh your pivot table, and add a decade column\n\n## Fancier calculated columns with DAX\n\n-   add a series col to your all_titles data\n-   `=related(novels[Series]) & related(short_stories[Series])` </br> ![Series column DAX](images/clipboard-515038106.png)\n\n## Fancier calculated columns with DAX\n\n-   add a `publication_year` column to your short_story data\n-  `=LOOKUPVALUE(short_story_collections[Year of first publication],short_story_collections[Title Name], short_stories[Collection]) ` </br> ![Publication year](images/clipboard-579564219.png)\n\n## Calculated columns work as ordinary pivot table data\n\n-   remember to refresh the data\n-   you may also need to re-create your pivot table if you add tables/relationships: glitchy!\n\n## Creating measures\n\n-   another way of using DAX to create values\n-   insert from the Power Pivot menu: </br>![Insert measure](images/clipboard-3327636246.png)\n-   then populate with a simple DAX calculation: `=AVERAGE(ssc[Number of stories])`\n- note the Table Name (which is where your measure will live)</br>![Create measure](images/clipboard-3534424614.png)\n\n## Using measures\n\n- you can then insert your measure in a Pivot Table\n- first refresh your pivot table\n- then look in the table you set as the Table Name to find your measure: </br>![Table Name](images/clipboard-2005550216.png)\n- now drag the measure to the `Values` field, and then populate `Rows` with `short_story_collection[Decade]` </br>![Pivot table with measure](images/clipboard-3383725040.png)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}