<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2025-11-04">
<title>Excel foundations 1 (intermediate Excel session 1) â€“ KIND training pages</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0b37c64f34216b628666a8dac638b53b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-64c611e38961a6caaced9b1829b0f356.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-0b37c64f34216b628666a8dac638b53b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../src/images/KLN_banner_v07_short_200.png" alt="" class="navbar-logo light-content"><img src="../src/images/KLN_banner_v07_short_200.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">KIND training pages</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../excel_main.html"> 
<span class="menu-text">Excel</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_main.html"> 
<span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../BI_main.html"> 
<span class="menu-text">Power Platform</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tableau_main.html"> 
<span class="menu-text">Tableau</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../skills_main.html"> 
<span class="menu-text">Skills</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">ðŸ“… Training schedule</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/NES-DEW/KIND-training">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/NES-DEW/KIND-training/issues">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#previous-attendees-have-said" id="toc-previous-attendees-have-said" class="nav-link active" data-scroll-target="#previous-attendees-have-said">Previous attendees have saidâ€¦</a></li>
  <li><a href="#session-outline" id="toc-session-outline" class="nav-link" data-scroll-target="#session-outline">Session outline</a></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">Tasks</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a></li>
  <li><a href="#a-first-task" id="toc-a-first-task" class="nav-link" data-scroll-target="#a-first-task">A first task</a></li>
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology">Terminology</a></li>
  <li><a href="#keyboard-shortcuts" id="toc-keyboard-shortcuts" class="nav-link" data-scroll-target="#keyboard-shortcuts">Keyboard shortcuts</a></li>
  <li><a href="#cells-and-formatting" id="toc-cells-and-formatting" class="nav-link" data-scroll-target="#cells-and-formatting">Cells and formatting</a></li>
  <li><a href="#rows-and-columns" id="toc-rows-and-columns" class="nav-link" data-scroll-target="#rows-and-columns">Rows and columns</a></li>
  <li><a href="#date-task" id="toc-date-task" class="nav-link" data-scroll-target="#date-task">Date task</a></li>
  <li><a href="#ranges-and-tables" id="toc-ranges-and-tables" class="nav-link" data-scroll-target="#ranges-and-tables">Ranges and tables</a></li>
  <li><a href="#table-exercise" id="toc-table-exercise" class="nav-link" data-scroll-target="#table-exercise">Table exercise</a></li>
  <li><a href="#selecting-tables" id="toc-selecting-tables" class="nav-link" data-scroll-target="#selecting-tables">Selecting tables</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#reference-task" id="toc-reference-task" class="nav-link" data-scroll-target="#reference-task">Reference task</a></li>
  <li><a href="#useful-tools-for-references" id="toc-useful-tools-for-references" class="nav-link" data-scroll-target="#useful-tools-for-references">Useful tools for references</a></li>
  <li><a href="#absolute-vs-relative-references" id="toc-absolute-vs-relative-references" class="nav-link" data-scroll-target="#absolute-vs-relative-references">Absolute vs relative references</a></li>
  <li><a href="#working-with-absolute-references" id="toc-working-with-absolute-references" class="nav-link" data-scroll-target="#working-with-absolute-references">Working with absolute references</a></li>
  <li><a href="#working-with-names" id="toc-working-with-names" class="nav-link" data-scroll-target="#working-with-names">Working with names</a></li>
  <li><a href="#why-bother-naming-things" id="toc-why-bother-naming-things" class="nav-link" data-scroll-target="#why-bother-naming-things">Why bother naming things?</a></li>
  <li><a href="#naming" id="toc-naming" class="nav-link" data-scroll-target="#naming">Naming</a></li>
  <li><a href="#adding-names" id="toc-adding-names" class="nav-link" data-scroll-target="#adding-names">Adding names</a></li>
  <li><a href="#the-name-manager" id="toc-the-name-manager" class="nav-link" data-scroll-target="#the-name-manager">The name manager</a></li>
  <li><a href="#the-go-to-menu" id="toc-the-go-to-menu" class="nav-link" data-scroll-target="#the-go-to-menu">The Go To menu</a></li>
  <li><a href="#thank-yous" id="toc-thank-yous" class="nav-link" data-scroll-target="#thank-yous">Thank yous</a></li>
  </ul></nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
<a property="dct:title" rel="cc:attributionURL" href="https://nes-dew.github.io/KIND-training">KIND learning network training materials</a> by <span property="cc:attributionName">KIND learning network</span> is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0<img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a>
</p>
<div style="text-align:center;">
<a href="https://forms.office.com/pages/responsepage.aspx?id=veDvEDCgykuAnLXmdF5Jmn79kl25VpJIq3eErXXCYKBUMUpENjBJOENINDRFMUlYQTlCM1RVNzRSRy4u&amp;route=shorturl" style="display:inline-block;max-width:250px;padding:8px 16px;background:#2C3792;color:#ffffff;font-family:'Segoe UI','Helvetica Neue',sans-serif;font-weight:700;font-size:16px;text-align:center;text-decoration:none;border-radius:20px;border:2px solid #A12693;cursor:pointer;transition:all .3s ease;" onmouseover="this.style.background='#A12693';this.style.color='#fff';this.style.borderColor='#fff'" onmouseout="this.style.background='#2C3792';this.style.color='#ffffff';this.style.borderColor='#A12693'">Join the KIND network</a>
</div>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Excel foundations 1 (intermediate Excel session 1)</h1>
  <div class="quarto-categories">
    <div class="quarto-category">excel</div>
    <div class="quarto-category">intermediate</div>
    <div class="quarto-category">Excel skill-builder</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header><p>This is a session in our intermediate-level Excel skill builder course. This consists of five practical training sessions, designed to be taken together, that are aimed at helping users with some prior Excel experience build and consolidate their skills. The sessions are:</p>
<ul>
<li>
<a href="../excel/excel_foundations_01.html">Excel foundations 1</a> (this session)</li>
<li><a href="../excel/excel_foundations_02.html">Excel foundations 2</a></li>
<li><a href="../excel/lookups_in_excel.html">Lookups in Excel</a></li>
<li><a href="../excel/excel_programming.html">Excel programming</a></li>
<li><a href="../excel/pivot_tables_and_pivot_charts.html">Pivot tables and pivot charts</a></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Session materials
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="src/KIND_excel_skills_s01_exercises.xlsx"><iconify-icon inline="" icon="ph:file-xls" style="font-size: 2em;" aria-label="Icon file-xls from ph Iconify.design set." title="Icon file-xls from ph Iconify.design set."></iconify-icon>.xlsx exercises</a></li>
<li><a href="src/KIND_excel_skills_s01_exercises_final.xlsx"><iconify-icon inline="" icon="ph:file-xls" style="font-size: 2em;" aria-label="Icon file-xls from ph Iconify.design set." title="Icon file-xls from ph Iconify.design set."></iconify-icon>.xlsx exercises (completed)</a></li>
</ul>
</div>
</div>
</div>
<section id="previous-attendees-have-said" class="level2 cell" data-layout-align="left"><h2 class="anchored" data-anchor-id="previous-attendees-have-said">Previous attendees have saidâ€¦</h2>
<ul>
<li>132 previous attendees have left feedback</li>
<li>97% would recommend this session to a colleague</li>
<li>91% said that this session was pitched correctly</li>
</ul>
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="excel_foundations_01_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-left figure-img" width="288"></p>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Three random comments from previous attendees
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Great learning experience, the speaker was very knowledgeable and he was very easy to listen to and made the learning very enjoyable. He was also very good at making everyone feel and ease and encouraged people to participate, which we did. Looking forward to the next session!</li>
<li>Was helpful and provided concise and clear information</li>
<li>Very useful, but sometimes presenter is a bit too fast talking through bits for me to do at the same time on my spreadsheet, but presenter does repeat it again, which is good.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Forthcoming session(s)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<table>
<thead><tr>
<th style="text-align:left;">
Booking link
</th>
<th style="text-align:left;">
Date
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
<a href="https://events.teams.microsoft.com/event/dc86f201-0f5c-4701-8ff3-e28dc9b8f3ac@10efe0bd-a030-4bca-809c-b5e6745e499a">Excel foundations 1 (intermediate Excel session 1)</a>
</td>
<td style="text-align:left;">
14:00-16:00 Thu 30th April 2026
</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</section><section id="session-outline" class="level2"><h2 class="anchored" data-anchor-id="session-outline">Session outline</h2>
<ul>
<li>most Excel questions can be broken down into these five areas
<ul>
<li>Cells and formatting</li>
<li>Ranges and tables</li>
<li>References</li>
<li>Formulas</li>
<li>Functions</li>
</ul>
</li>
<li>weâ€™ll look at cells, ranges, and references in this session</li>
</ul></section><section id="tasks" class="level2"><h2 class="anchored" data-anchor-id="tasks">Tasks</h2>
<ul>
<li>there are tasks throughout the training session</li>
<li>theyâ€™re described in the green boxes</li>
<li>please follow along with the tasks</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>this is the first step of the task</li>
<li>this is the next step</li>
</ol>
</div>
</div>
</section><section id="getting-started" class="level2"><h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<ul>
<li>this course is written for M365 Excel (desktop)</li>
<li>other versions of Excel are available, and will work in a similar way</li>
<li>files for today:
<ul>
<li>
<code>s01_exercises.xlsx</code> is a starting-point for the exercises today</li>
<li>
<code>s01_exercises_final.xlsx</code> is the end-point for the exercises today - itâ€™s there to help if you get stuck or lost</li>
</ul>
</li>
</ul></section><section id="a-first-task" class="level2"><h2 class="anchored" data-anchor-id="a-first-task">A first task</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>open the sample spreadsheet <code>s01_exercises.xlsx</code> and have a look around</li>
<li>find the <code>service_use</code> worksheet</li>
</ol>
</div>
</div>
</section><section id="terminology" class="level2"><h2 class="anchored" data-anchor-id="terminology">Terminology</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="../src/images/interface.png" class="img-fluid figure-img"></p>
<figcaption>Excel interface</figcaption></figure>
</div>
<ul>
<li>worksheet / workbook distinction</li>
<li>
<code>Ctrl</code> + <code>F1</code> to hide the ribbon</li>
</ul></section><section id="keyboard-shortcuts" class="level2"><h2 class="anchored" data-anchor-id="keyboard-shortcuts">Keyboard shortcuts</h2>
<ul>
<li>Excel is rich in keyboard shortcuts</li>
<li>these shortcuts are a great way to build speed and fluency</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Press <code>Alt</code>
</li>
<li>Try exploring the ribbon using the keyboard shortcuts</li>
</ol>
</div>
</div>
</section><section id="cells-and-formatting" class="level2"><h2 class="anchored" data-anchor-id="cells-and-formatting">Cells and formatting</h2>
<ol type="1">
<li>Excel sheets are made up of cells</li>
<li>each cell can contain either a <strong>value</strong> or a <strong>formula</strong>
</li>
<li>cells can be formatted
<ol type="a">
<li>sometimes thatâ€™s just text formatting, like size, colour, etc</li>
<li>sometimes thatâ€™s <strong>number format</strong>, which changes the value in the cell</li>
</ol>
</li>
<li>formatting can be <strong>conditional</strong>, where formatting changes based on cell values. We talk about this in a later session</li>
</ol></section><section id="rows-and-columns" class="level2"><h2 class="anchored" data-anchor-id="rows-and-columns">Rows and columns</h2>
<ol type="1">
<li>cells are arranged in rows and columns  <img src="../src/images/cols.png" class="img-fluid" alt="Rows and columns">
</li>
<li>columns usually have letters, and rows have numbers</li>
</ol></section><section id="date-task" class="level2"><h2 class="anchored" data-anchor-id="date-task">Date task</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>look at the values in the first 15 rows of the <strong>date</strong> column <img src="../src/images/1900.png" class="img-fluid" alt="1900 dates">
</li>
<li>Excel <a href="https://support.microsoft.com/en-us/office/date-systems-in-excel-e7fe7167-48a9-4b96-bb53-5612a800b487">generally</a> stores dates using the <em>1900 date system</em>, which is the number of days since Jan 1st 1900 - so <code>44570</code> stands for the 9th of January 2022</li>
<li>we can format these into something human-readable. Please select all the cells in that date column and change the number format to <strong>Short date</strong> <img src="../src/images/format.png" height="100" alt="Change number format to Short Date"> 1. or use <code>Alt</code>, <code>H</code>, <code>N</code>, <code>S</code> 1. or <code>Ctrl</code> + <code>1</code> and select from the dropdown</li>
</ol>
</div>
</div>
</section><section id="ranges-and-tables" class="level2"><h2 class="anchored" data-anchor-id="ranges-and-tables">Ranges and tables</h2>
<ul>
<li>any group of cells is called a <strong>range</strong>
</li>
<li>we can convert ranges to <strong>tables</strong>
</li>
<li>tables have lots of useful features
<ul>
<li>automatic formatting of headings</li>
<li>auto filters</li>
<li>flash fill</li>
<li>â€¦</li>
</ul>
</li>
</ul></section><section id="table-exercise" class="level2"><h2 class="anchored" data-anchor-id="table-exercise">Table exercise</h2>
<ul>
<li>letâ€™s turn a range into a table</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>the first 15 rows and 5 columns of our exercise worksheet contain a range</li>
<li>please select all of those cells</li>
<li>then select <strong>Format as Table</strong> from the ribbon (or <code>Ctrl</code> + <code>T</code>) <img src="../src/images/table.png" class="img-fluid" alt="Format as table">
</li>
</ol>
</div>
</div>
<ul>
<li>you can also convert a table back into a range using the <code>Convert to Range</code> tool <img src="../src/images/01_converttorange.png" class="img-fluid" alt="Convert to range">
</li>
</ul></section><section id="selecting-tables" class="level2"><h2 class="anchored" data-anchor-id="selecting-tables">Selecting tables</h2>
<ul>
<li>within a table press <code>Ctrl</code> + <code>A</code> to select all values</li>
<li>press <code>Ctrl</code> + <code>A</code> again to include the headers in the selection</li>
<li>and press <code>Ctrl</code> + <code>A</code> a third time to include the entire worksheet</li>
</ul></section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li>references are the â€˜addressâ€™ of a particular cell</li>
<li>references are usually made up of a letter and a number (like <strong>A2</strong>, <strong>B56</strong>, â€¦)
<ul>
<li>the letter stands for the column a cell is in</li>
<li>the number stands for the row</li>
</ul>
</li>
<li>we can use those references in formulas
<ul>
<li>
<code>=A1</code> will copy the values from A1 into the current cell</li>
</ul>
</li>
</ul></section><section id="reference-task" class="level2"><h2 class="anchored" data-anchor-id="reference-task">Reference task</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>using A1 reference, can you populate the first three rows of the summary table? <img src="../src/images/ref_task.png" class="img-fluid" alt="Populate the summary table"><ol type="a">
<li>Start date</li>
<li>End date</li>
<li>First duty manager</li>
</ol>
</li>
<li>you might need to switch off <strong>Calculated Columns</strong> from the floatie <img src="../src/images/01_stop_calc.png" class="img-fluid" alt="Switch off calculated columns">
</li>
</ol>
</div>
</div>
</section><section id="useful-tools-for-references" class="level2"><h2 class="anchored" data-anchor-id="useful-tools-for-references">Useful tools for references</h2>
<ul>
<li>select a range of cells using <code>:</code> - so <code>=A1:C3</code> will select the nine cells at the top left-hand corner of the sheet</li>
<li>to select everything in a column(s), you can use a column letter and the range operator - so <code>=SUM(D:D)</code> would be a quick way of summing every value in the D column</li>
<li>you can also use <code>.</code> to trim blank values from this range. More info on the <a href="https://support.microsoft.com/en-us/office/trimrange-function-d7812248-3bc5-4c6b-901c-1afa9564f999">Microsoft learn pages</a>.</li>
</ul></section><section id="absolute-vs-relative-references" class="level2"><h2 class="anchored" data-anchor-id="absolute-vs-relative-references">Absolute vs relative references</h2>
<ul>
<li>by default, A1 references are <strong>relative</strong>
<ul>
<li>if the formula moves, the reference will change</li>
</ul>
</li>
<li>as youâ€™ve seen, relative references can cause problems</li>
<li>you can change relative references to absolute (=fixed) references using <code>$</code>
<ul>
<li>
<code>$A$1</code> refers to A1 <strong>no matter what</strong>
<ul>
<li>use this if you absolutely always want to refer to the same cell</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>update your relative references in the summary table to absolute references</li>
</ol>
</div>
</div>
</section><section id="working-with-absolute-references" class="level2"><h2 class="anchored" data-anchor-id="working-with-absolute-references">Working with absolute references</h2>
<ul>
<li>thereâ€™s a bit more to say about absolute references
<ul>
<li>
<code>$A1</code> will be absolute in the column, but relative in the rows</li>
<li>
<code>A$1</code> will be relative in the row, but absolute in the column</li>
</ul>
</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>if you click in the formula bar, <code>F4</code> toggles absolute/relative
<ul>
<li>relative &gt; absolute &gt; abs row &gt; abs col</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>try changing your 3 absolute references to abs col references (like <code>$A2</code>)</li>
<li>now try copying the managerâ€™s name down the column</li>
<li>now try copying the managerâ€™s name along the row</li>
<li>does this behave as youâ€™d expect?</li>
<li>(please remove any of this copied data now - we wonâ€™t use it again)</li>
</ol>
</div>
</div>
</section><section id="working-with-names" class="level2"><h2 class="anchored" data-anchor-id="working-with-names">Working with names</h2>
<ul>
<li>we can name cells in Excel</li>
<li>this is done using the name box  <img src="../src/images/01_name_box.png" class="img-fluid" alt="The name box">
</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>select B18</li>
<li>in the name box, please type a useful short name and confirm with <code>Ctrl</code> + <code>Enter</code>
</li>
<li>please repeat for the other two value cells in the summary table</li>
</ol>
</div>
</div>
</section><section id="why-bother-naming-things" class="level2"><h2 class="anchored" data-anchor-id="why-bother-naming-things">Why bother naming things?</h2>
<ul>
<li>we can use those names in formulas</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Task
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>in a random cell, use <code>TEXT()</code> to find the days of the week from each of your start and end dates</li>
<li>for example, my start date is named <code>start_date</code>, so <code>=TEXT(start_date, "dddd")</code> gives me <code>Saturday</code>
</li>
</ol>
</div>
</div>
<ul>
<li>they have semantic content: itâ€™s easier to understand what <code>start_date</code> means compared to <code>B17</code>
</li>
<li>naming important values helps lower the complexity of formulas by:
<ul>
<li>making it obvious what is being referred to</li>
<li>allowing you to change the location of a cell - as long as the name is retained, the formulas will continue to work</li>
</ul>
</li>
<li>we can name lots of other parts of Excel sheets too</li>
</ul></section><section id="naming" class="level2"><h2 class="anchored" data-anchor-id="naming">Naming</h2>
<ul>
<li>most objects in Excel can be named - including cells, tables, and ranges
<ul>
<li>special case - <code>Table[Column]</code> shorthand for columns. This is known as <strong>structured referencing</strong>
</li>
</ul>
</li>
<li>those names will work like variable names</li>
<li>you can see names in the <strong>name box</strong> to the left of the formula bar</li>
</ul></section><section id="adding-names" class="level2"><h2 class="anchored" data-anchor-id="adding-names">Adding names</h2>
<ul>
<li>the easiest way to name a cell is to click in that cell, then edit using the name box (to the left of the formula bar)</li>
<li>there are a few <a href="https://support.microsoft.com/en-au/office/names-in-formulas-fc2935f9-115d-4bef-a370-3aa8bb4c91f1">name rules</a>
<ul>
<li>donâ€™t make names that look like references</li>
<li>donâ€™t include spaces</li>
<li>donâ€™t rely on case (Excel in general is case insensitive)</li>
<li>keep them shortish (less than 255 chars)</li>
<li>avoid numbers at the start of names</li>
</ul>
</li>
</ul></section><section id="the-name-manager" class="level2"><h2 class="anchored" data-anchor-id="the-name-manager">The name manager</h2>
<ul>
<li>you can review names using the <strong>name manager</strong> via <code>Ctrl</code> + <code>F3</code>
<ul>
<li>note reference, scope, and value</li>
<li>
<code>Ctrl + J</code> for new lines in name manager</li>
<li>
<code>F2</code> switches between edit and enter mode</li>
</ul>
</li>
</ul></section><section id="the-go-to-menu" class="level2"><h2 class="anchored" data-anchor-id="the-go-to-menu">The Go To menu</h2>
<ul>
<li>you can use names to navigate using the <strong>Go To</strong> menu via <code>F5</code>
<ul>
<li>gives you an overview of the names in play</li>
<li>quick navigation shortcut</li>
</ul>
</li>
</ul></section><section id="thank-yous" class="level2"><h2 class="anchored" data-anchor-id="thank-yous">Thank yous</h2>
<p>Iâ€™m grateful to Jennifer Watt, John Mackintosh, Duncan Sage, David Coigach, Michael Robb, Angela Godfrey, Spela Oberstar, Andrew Christopherson, and other members of the KIND network for their valuable suggestions and corrections to these training materials</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/NES-DEW\.github\.io\/KIND-training\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->



</body></html>