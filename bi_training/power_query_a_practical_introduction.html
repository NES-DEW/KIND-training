<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2026-02-18">
<title>PowerQuery - a practical introduction ‚Äì KIND training pages</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-afa37c5c79185640b9c231024f4fe5ea.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-65d1093586cbabf37991027e2806ae75.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-afa37c5c79185640b9c231024f4fe5ea.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../src/images/KLN_banner_v07_short_200.png" alt="" class="navbar-logo light-content"><img src="../src/images/KLN_banner_v07_short_200.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">KIND training pages</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../excel_main.html"> 
<span class="menu-text">Excel</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_main.html"> 
<span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../BI_main.html"> 
<span class="menu-text">Power Platform</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tableau_main.html"> 
<span class="menu-text">Tableau</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../skills_main.html"> 
<span class="menu-text">Skills</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">üìÖ Training schedule</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/NES-DEW/KIND-training">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/NES-DEW/KIND-training/issues">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#previous-attendees-have-said" id="toc-previous-attendees-have-said" class="nav-link active" data-scroll-target="#previous-attendees-have-said">Previous attendees have said‚Ä¶</a></li>
  <li><a href="#welcome" id="toc-welcome" class="nav-link" data-scroll-target="#welcome">Welcome</a></li>
  <li><a href="#session-outline" id="toc-session-outline" class="nav-link" data-scroll-target="#session-outline">Session outline</a></li>
  <li><a href="#what-is-powerquery" id="toc-what-is-powerquery" class="nav-link" data-scroll-target="#what-is-powerquery">What is PowerQuery?</a></li>
  <li><a href="#how-i-think-of-powerquery" id="toc-how-i-think-of-powerquery" class="nav-link" data-scroll-target="#how-i-think-of-powerquery">How I think of PowerQuery</a></li>
  <li><a href="#getting-data-into-powerquery" id="toc-getting-data-into-powerquery" class="nav-link" data-scroll-target="#getting-data-into-powerquery">Getting data into PowerQuery</a></li>
  <li><a href="#first-view-of-powerquery" id="toc-first-view-of-powerquery" class="nav-link" data-scroll-target="#first-view-of-powerquery">First view of PowerQuery</a></li>
  <li><a href="#basic-data-wrangling" id="toc-basic-data-wrangling" class="nav-link" data-scroll-target="#basic-data-wrangling">Basic data wrangling</a></li>
  <li><a href="#replacing-values" id="toc-replacing-values" class="nav-link" data-scroll-target="#replacing-values">Replacing values</a></li>
  <li><a href="#reshaping-data" id="toc-reshaping-data" class="nav-link" data-scroll-target="#reshaping-data">Reshaping data</a></li>
  <li><a href="#add-columns" id="toc-add-columns" class="nav-link" data-scroll-target="#add-columns">Add columns</a></li>
  <li><a href="#close-and-load-close-and-apply-sends-your-data-back-to-excelpower-bi" id="toc-close-and-load-close-and-apply-sends-your-data-back-to-excelpower-bi" class="nav-link" data-scroll-target="#close-and-load-close-and-apply-sends-your-data-back-to-excelpower-bi">Close and load / Close and Apply sends your data back to Excel/Power BI</a></li>
  <li><a href="#getting-more-fancy-a-bigger-dataset" id="toc-getting-more-fancy-a-bigger-dataset" class="nav-link" data-scroll-target="#getting-more-fancy-a-bigger-dataset">Getting more fancy: a bigger dataset</a></li>
  <li>
<a href="#a-challenge" id="toc-a-challenge" class="nav-link" data-scroll-target="#a-challenge">A challenge</a>
  <ul class="collapse">
<li><a href="#some-hints" id="toc-some-hints" class="nav-link" data-scroll-target="#some-hints">Some hints</a></li>
  </ul>
</li>
  </ul></nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
<a property="dct:title" rel="cc:attributionURL" href="https://nes-dew.github.io/KIND-training">KIND learning network training materials</a> by <span property="cc:attributionName">KIND learning network</span> is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0<img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a>
</p>
<div style="text-align:center;">
<a href="https://forms.office.com/pages/responsepage.aspx?id=veDvEDCgykuAnLXmdF5Jmn79kl25VpJIq3eErXXCYKBUMUpENjBJOENINDRFMUlYQTlCM1RVNzRSRy4u&amp;route=shorturl" style="display:inline-block;max-width:250px;padding:8px 16px;background:#2C3792;color:#ffffff;font-family:'Segoe UI','Helvetica Neue',sans-serif;font-weight:700;font-size:16px;text-align:center;text-decoration:none;border-radius:20px;border:2px solid #A12693;cursor:pointer;transition:all .3s ease;" onmouseover="this.style.background='#A12693';this.style.color='#fff';this.style.borderColor='#fff'" onmouseout="this.style.background='#2C3792';this.style.color='#ffffff';this.style.borderColor='#A12693'">Join the KIND network</a>
</div>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">PowerQuery - a practical introduction</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Power BI</div>
    <div class="quarto-category">PowerQuery</div>
    <div class="quarto-category">Excel</div>
    <div class="quarto-category">beginner</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 18, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="previous-attendees-have-said" class="level2 cell" data-layout-align="left"><h2 class="anchored" data-anchor-id="previous-attendees-have-said">Previous attendees have said‚Ä¶</h2>
<ul>
<li>40 previous attendees have left feedback</li>
<li>95% would recommend this session to a colleague</li>
<li>88% said that this session was pitched correctly</li>
</ul>
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="power_query_a_practical_introduction_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-left figure-img" width="288"></p>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Three random comments from previous attendees
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Definitely more intermediate, but great info. Well explained</li>
<li>I‚Äôve only said no as we don‚Äôt have up to date desktop versions of the software installed, and couldn‚Äôt make it work in our outdated 2013 version, so struggled to follow. No reflection on Brendan‚Äôs excellent (as ever) style or delivery.</li>
<li>issues in loading data and due to speed of which trainer was moving at could not follow along. transpired i needed an addon to excel and had to leave the session</li>
</ul>
</div>
</div>
</section><section id="welcome" class="level2"><h2 class="anchored" data-anchor-id="welcome">Welcome</h2>
<p>This session is üå∂ a beginner-level introduction to PowerQuery. It‚Äôs practical, so you‚Äôll need access to PowerQuery to complete the session. There are three ways of getting that access. In order of preference, you can use either:</p>
<ul>
<li>M365 Excel desktop (best and easiest for this training)</li>
<li>Power BI desktop (also completely fine)</li>
<li>
<a href="https://excel.cloud.microsoft/">M365 Excel on the web</a> in a pinch - this is still new and experimental</li>
</ul>
<p>There are also several other versions of PowerQuery available in older versions of Excel on the desktop. We‚Äôd recommend <strong>not</strong> using those for this session as there are many differences between all the versions, and we can‚Äôt accommodate all of those in a session like this. You‚Äôll also definitely need basic competency in Excel or Power BI to get the most out of this session.</p>
</section><section id="session-outline" class="level2"><h2 class="anchored" data-anchor-id="session-outline">Session outline</h2>
<ul>
<li>what is PowerQuery, and why might you use it?</li>
<li>getting data into PowerQuery</li>
<li>basic data wrangling</li>
<li>joins (merges)</li>
<li>pivots</li>
</ul></section><section id="what-is-powerquery" class="level2"><h2 class="anchored" data-anchor-id="what-is-powerquery">What is PowerQuery?</h2>
<ul>
<li>Microsoft call it a <a href="https://learn.microsoft.com/en-us/power-query/power-query-what-is-power-query">‚Äúdata transformation and data preparation engine‚Äù</a>
</li>
<li>it‚Äôs been around since 2010, initially in Excel, and then in both Excel and Power BI</li>
<li>uses code (<a href="https://en.wikipedia.org/wiki/Power_Query">M Formula language</a>) but has GUI tools for most tasks</li>
<li>appears in several different Microsoft tools</li>
</ul></section><section id="how-i-think-of-powerquery" class="level2"><h2 class="anchored" data-anchor-id="how-i-think-of-powerquery">How I think of PowerQuery</h2>
<ul>
<li>the right way to load any real data into Excel</li>
<li>the best way to avoid repeating yourself when you‚Äôre doing Excel work</li>
<li>the easiest route to automated or standardised data wrangling currently available</li>
</ul></section><section id="getting-data-into-powerquery" class="level2"><h2 class="anchored" data-anchor-id="getting-data-into-powerquery">Getting data into PowerQuery</h2>
<p>We‚Äôll use some historical data about scurvy testing from the <a href="https://cran.r-project.org/web/packages/medicaldata/index.html">medicaldata r package</a> for the first part of this session. Data loading is where the three flavours of PowerQuery we‚Äôre using diverge most, so do please make sure you pick the correct data loading instructions for your version below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Excel desktop</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Power BI</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Excel web</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ol type="1">
<li>Open Excel and create a new, blank, workbook</li>
<li>
<code>Data</code> &gt; <code>Get &amp; Transform Data</code>  <img src="../src/images/clipboard-2636372440.png" class="img-fluid" alt="Get &amp; Transform Data">
</li>
<li>Pick <code>From Web</code> and supply the following URL - <code>https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-07-25/scurvy.csv</code>
</li>
<li>From the preview, select <code>Transform data</code> to open PowerQuery</li>
</ol>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ol type="1">
<li>Open Power BI and start a new report</li>
<li>Select <code>Get data</code> &gt; <code>From Web</code> button in the ribbon <img src="../src/images/clipboard-2012149707.png" height="200" alt="Get data from web">
</li>
<li>Supply the following URL - <code>https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-07-25/scurvy.csv</code> <img src="../src/images/clipboard-1484642386.png" class="img-fluid" alt="supply a URL">
</li>
<li>From the preview, select <code>Transform data</code> to open PowerQuery  <img src="../src/images/clipboard-4163607856.png" class="img-fluid" alt="Select Transform data to open PowerQuery">
</li>
<li>If you‚Äôve already got some data in your report that you‚Äôd like to transform, use <code>Tranform data</code> in the ribbon to open PowerQuery:  <img src="../src/images/clipboard-1924567552.png" class="img-fluid" alt="Tranform data in the ribbon">
</li>
</ol>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>There are some limitations for most users about loading data from external sources at present. That means that we‚Äôll use a different method to create some accessible starting data. This limitation appears to be teething trouble at present (Feb 2026), but do investigate any current issues before committing to real PowerQuery projects in practice.</p>
<ol type="1">
<li>Go to <a href="https://excel.cloud.microsoft/" class="uri">https://excel.cloud.microsoft/</a>, log in, and create a blank workbook</li>
<li>Then copy and paste the following data into that workbook:</li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 30%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th>study_id</th>
<th>treatment</th>
<th>dosing_regimen_for_scurvy</th>
<th>gum_rot_d6</th>
<th>skin_sores_d6</th>
<th>weakness_of_the_knees_d6</th>
<th>lassitude_d6</th>
<th>fit_for_duty_d6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>cider</td>
<td>1 quart per day</td>
<td>2_moderate</td>
<td>2_moderate</td>
<td>2_moderate</td>
<td>2_moderate</td>
<td>0_no</td>
</tr>
<tr class="even">
<td>2</td>
<td>cider</td>
<td>1 quart per day</td>
<td>2_moderate</td>
<td>1_mild</td>
<td>2_moderate</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="odd">
<td>3</td>
<td>dilute_sulfuric_acid</td>
<td>25 drops of elixir of vitriol, three times a day</td>
<td>1_mild</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="even">
<td>4</td>
<td>dilute_sulfuric_acid</td>
<td>25 drops of elixir of vitriol, three times a day</td>
<td>2_moderate</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="odd">
<td>5</td>
<td>vinegar</td>
<td>two spoonfuls, three times daily</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="even">
<td>6</td>
<td>vinegar</td>
<td>two spoonfuls, three times daily</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="odd">
<td>7</td>
<td>sea_water</td>
<td>half pint daily</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="even">
<td>8</td>
<td>sea_water</td>
<td>half pint daily</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="odd">
<td>9</td>
<td>citrus</td>
<td>two lemons and an orange daily</td>
<td>1_mild</td>
<td>1_mild</td>
<td>0_none</td>
<td>1_mild</td>
<td>0_no</td>
</tr>
<tr class="even">
<td>10</td>
<td>citrus</td>
<td>two lemons and an orange daily</td>
<td>0_none</td>
<td>0_none</td>
<td>0_none</td>
<td>0_none</td>
<td>1_yes</td>
</tr>
<tr class="odd">
<td>11</td>
<td>purgative_mixture</td>
<td>a nutmeg-sized paste of garlic, mustard seed, horseradish, balsam of Peru, and gum myrrh three times a day</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
<tr class="even">
<td>12</td>
<td>purgative_mixture</td>
<td>a nutmeg-sized paste of garlic, mustard seed, horseradish, balsam of Peru, and gum myrrh three times a day</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>3_severe</td>
<td>0_no</td>
</tr>
</tbody>
</table>
<ol start="3" type="1">
<li>Convert your data into a table (<code>Insert</code> &gt; <code>Table</code>) with headers</li>
<li>Then load that table into PowerQuery <code>Data</code> &gt; <code>Get &amp; Transform Data</code> &gt; <code>From Table/Range</code> <img src="images/clipboard-2602479521.png" class="img-fluid" alt="Loading data into PowerQuery">
</li>
</ol>
</div>
</div>
</div>
</section><section id="first-view-of-powerquery" class="level2"><h2 class="anchored" data-anchor-id="first-view-of-powerquery">First view of PowerQuery</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="../src/images/clipboard-1738142120.png" class="img-fluid figure-img"></p>
<figcaption>First view of PowerQuery</figcaption></figure>
</div>
<ul>
<li>Queries (= datasets) on the left</li>
<li>ribbon menu at the top</li>
<li>Query settings (= the changes you‚Äôll make to your data) on the right</li>
<li>Excel-ish data preview in the middle</li>
</ul></section><section id="basic-data-wrangling" class="level2"><h2 class="anchored" data-anchor-id="basic-data-wrangling">Basic data wrangling</h2>
<ul>
<li>right click the <code>study_id</code> column and select <code>Remove</code>
<ul>
<li>the column will disappear</li>
<li>but you‚Äôll also gain a step in your Applied Steps field <img src="../src/images/clipboard-1788638263.png" class="img-fluid">
</li>
</ul>
</li>
<li>you can edit this step
<ul>
<li>if you‚Äôre code-confident, you can edit the formula to read <code>= Table.RemoveColumns(#"Changed Type",{"study_id", "treatment"})</code> to also remove the treatment column</li>
<li>and you can remove the step using the X next to the step name <img src="../src/images/clipboard-3939638955.png" class="img-fluid">
</li>
</ul>
</li>
<li>you should also try renaming and reordering your columns in the same way</li>
<li>once you‚Äôve had a play, please remove the steps until you‚Äôre left with the data you started with (so delete back to ‚ÄúChanged Type‚Äù)</li>
</ul></section><section id="replacing-values" class="level2"><h2 class="anchored" data-anchor-id="replacing-values">Replacing values</h2>
<ul>
<li>we can also work with individual values</li>
<li>our values are a number, then an underscore, then a word</li>
<li>we can <code>Split column</code> at the underscore</li>
<li>we could also replace the odd underscores in the treatment column</li>
</ul></section><section id="reshaping-data" class="level2"><h2 class="anchored" data-anchor-id="reshaping-data">Reshaping data</h2>
<ul>
<li>we could go column by column here splitting, but an easier approach would be to re-shape the data</li>
<li>select the first three columns, and select <code>Unpivot Other Columns</code> <img src="../src/images/clipboard-1884864280.png" class="img-fluid">
</li>
<li>then split, change type, and generally tidy up</li>
</ul></section><section id="add-columns" class="level2"><h2 class="anchored" data-anchor-id="add-columns">Add columns</h2>
<p>Our treatment and dosing columns are annoying. Let‚Äôs make a new, joined, column for them:</p>
<ul>
<li>select <code>Custom Column</code><img src="../src/images/clipboard-1596515682.png" class="img-fluid" alt="Custom Column">
</li>
<li>you can click the gearwheel next to the step if you‚Äôd like to go back and tweak</li>
</ul></section><section id="close-and-load-close-and-apply-sends-your-data-back-to-excelpower-bi" class="level2"><h2 class="anchored" data-anchor-id="close-and-load-close-and-apply-sends-your-data-back-to-excelpower-bi">Close and load / Close and Apply sends your data back to Excel/Power BI</h2>
<p><img src="../src/images/clipboard-2525392040.png" class="img-fluid"></p>
</section><section id="getting-more-fancy-a-bigger-dataset" class="level2"><h2 class="anchored" data-anchor-id="getting-more-fancy-a-bigger-dataset">Getting more fancy: a bigger dataset</h2>
<ul>
<li>please load the <a href="https://www.gov.scot/binaries/content/documents/govscot/publications/statistics/2024/05/health-and-care-experience-survey-2023-to-2024-results-by-geography/documents/health-and-care-experience-survey-2023-to-2024-geographical-data/health-and-care-experience-survey-2023-to-2024-geographical-data/govscot%3Adocument/Health%2Band%2BCare%2BExperience%2BSurvey%2B2023%2Bto%2B2024%2B-tables%2Bof%2Bresults%2Bby%2Bgeography.xlsx">Health and Care Experience survey results from 2023-4</a> <img src="../src/images/clipboard-738553132.png" class="img-fluid">
</li>
<li>or <a href="https://github.com/NES-DEW/KIND-training/raw/main/excel/src/HACE_2023-4.xlsx">alternative local version</a>
</li>
<li>for Excel on the web, you‚Äôll need to download that file to your computer, then upload to Excel on the web before opening the data in PowerQuery</li>
<li>please load both the proper datasets (and ignore the background) <img src="../src/images/clipboard-4050914485.png" height="200" alt="Load both the proper datasets">
</li>
</ul></section><section id="a-challenge" class="level2"><h2 class="anchored" data-anchor-id="a-challenge">A challenge</h2>
<p>Can you find the number of responses to each question for your local NHS board? You should be able to re-work this data to give something like: <img src="../src/images/clipboard-3334683078.png" class="img-fluid"></p>
<section id="some-hints" class="level3"><h3 class="anchored" data-anchor-id="some-hints">Some hints</h3>
<ul>
<li>filtering works like Excel, but is destructive</li>
<li>unpivoting, doing something to all the rows, then re-pivoting is a great way to work across lots of columns</li>
<li>you can join structurally similar datasets using <code>Append Queries as New</code><img src="../src/images/clipboard-3061387544.png" class="img-fluid" alt="Append Queries as New">
</li>
<li>you can deduplicate entire datasets by selecting all the columns and using <code>Remove Rows</code> &gt; <code>Remove Duplicates</code>
</li>
</ul>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/NES-DEW\.github\.io\/KIND-training\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->



</body></html>